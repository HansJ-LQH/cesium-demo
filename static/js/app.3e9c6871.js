(function(e){function t(t){for(var n,a,s=t[0],c=t[1],u=t[2],l=0,f=[];l<s.length;l++)a=s[l],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&f.push(r[a][0]),r[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);h&&h(t);while(f.length)f.shift()();return o.push.apply(o,u||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,a=1;a<i.length;a++){var c=i[a];0!==r[c]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=i[0]))}return e}var n={},r={app:0},o=[];function a(e){return s.p+"static/js/"+({}[e]||e)+"."+{"chunk-429c32b9":"26287226","chunk-60cc0512":"e07c57c2","chunk-40064d5e":"b671c29f","chunk-01877047":"275312e1","chunk-a5846a34":"55d82393"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.e=function(e){var t=[],i=r[e];if(0!==i)if(i)t.push(i[2]);else{var n=new Promise((function(t,n){i=r[e]=[t,n]}));t.push(i[2]=n);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=a(e);var u=new Error;o=function(t){c.onerror=c.onload=null,clearTimeout(l);var i=r[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",u.name="ChunkLoadError",u.type=n,u.request=o,i[1](u)}r[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:c})}),12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var h=u;o.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"2fa2":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{attrs:{id:"cesiumContainer"}})])}],o=i("c218"),a={name:"CesiumMap",data:function(){return{}},components:{},methods:{},mounted:function(){o["a"].init()}},s=a,c=(i("789e"),i("2877")),u=Object(c["a"])(s,n,r,!1,null,null,null);t["default"]=u.exports},"429a":function(e,t){function i(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="429a"},"4f8e":function(e,t,i){},5143:function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),r=i("ec35"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},a=[],s=(i("5c0b"),i("2877")),c={},u=Object(s["a"])(c,o,a,!1,null,null,null),l=u.exports,h=i("8c4f"),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home"},[i("CesiumMap"),i("CesiumTools"),i("TiltPhotography")],1)},d=[],m={name:"Home",components:{}},v=m,p=Object(s["a"])(v,f,d,!1,null,"0604f9e8",null),g=p.exports;n["a"].use(h["a"]);var b=[{path:"/",name:"Home",component:g}],y=new h["a"]({mode:"hash",base:"",routes:b}),_=y,w=i("2f62"),C=i("fcc2"),O={changeTiltPhotographyVisibility:function(e,t){e.tiltPhotographyVisibility=t}},x=O;n["a"].use(w["a"]);var k=new w["a"].Store({state:C["a"],mutations:x,actions:{},modules:{}}),P=(i("d3b7"),i("159b"),i("ddb0"),i("b0c0"),i("ffe0")),T={install:function(e){P.keys().forEach((function(t){var i=P(t).default;e.component(i.name,i)}))}},M=i("5143"),j=i.n(M);i("e877");window.CESIUM_BASE_URL="/Cesium/",window.Cesium=r,n["a"].use(j.a),n["a"].use(T),n["a"].config.productionTip=!1,new n["a"]({router:_,store:k,render:function(e){return e(l)}}).$mount("#app")},"5c0b":function(e,t,i){"use strict";var n=i("9c0c"),r=i.n(n);r.a},"789e":function(e,t,i){"use strict";var n=i("9288"),r=i.n(n);r.a},"78a0":function(e,t,i){"use strict";var n=i("ab03"),r=i.n(n);r.a},9288:function(e,t,i){},"9c0c":function(e,t,i){},a9c3:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cesium-tools"},[i("div",{staticClass:"cesium-tools-btn",on:{click:e.resetZoomView}},[e._v("H")]),i("div",{staticClass:"cesium-tools-btn",on:{click:e.resetPitch}},[e._v("L")]),i("div",{staticClass:"cesium-tools-btn",on:{click:function(t){return e.changeZoomLevel(1)}}},[e._v("+")]),i("div",{staticClass:"cesium-tools-btn"},[e._v(e._s(e.currentLevel))]),i("div",{staticClass:"cesium-tools-btn",on:{click:function(t){return e.changeZoomLevel(-1)}}},[e._v("-")]),i("div",{class:"cesium-tools-btn "+(e.tiltPhotographyVisibility?"cesium-tools-btn-hover":""),on:{click:e.changeTiltPhotographyVisibility}},[e._v(" 倾 ")])])},r=[],o=i("c218"),a={name:"CesiumTools",data:function(){return{currentLevel:2,tiltPhotographyVisibility:!1}},components:{},methods:{changeTiltPhotographyVisibility:function(){this.tiltPhotographyVisibility=!this.tiltPhotographyVisibility,this.$store.commit("changeTiltPhotographyVisibility",this.tiltPhotographyVisibility)},resetZoomView:function(){o["a"].resetZoomView()},resetPitch:function(){o["a"].resetPitch()},changeZoomLevel:function(e){var t=this.currentLevel+e;t<1||t>24||(this.currentLevel=t,o["a"].zoomLevel(t))},_zoomChanged:function(){var e=Math.ceil(o["a"].viewer.camera.positionCartographic.height);this.currentLevel=+o["a"].heightToZoom(e)}},mounted:function(){o["a"].viewer.camera.moveEnd.addEventListener(this._zoomChanged)}},s=a,c=(i("cc73"),i("2877")),u=Object(c["a"])(s,n,r,!1,null,"da065ece",null);t["default"]=u.exports},ab03:function(e,t,i){},c218:function(e,t,i){"use strict";i("d3b7"),i("4ae1");var n=i("d4ec"),r=i("bee2"),o=i("257e"),a=i("262e"),s=i("99de"),c=i("7e84"),u=i("9072"),l=(i("b680"),i("fcc2")),h=(i("a434"),i("159b"),i("ddb0"),function(e){if(e.extensionsUsed){var t=e.extensionsUsed.indexOf("KHR_technique_webgl"),i=e.extensionsRequired.indexOf("KHR_technique_webgl");if(-1!==t){e.extensionsRequired.splice(i,1,"KHR_techniques_webgl"),e.extensionsUsed.splice(t,1,"KHR_techniques_webgl"),e.extensions=e.extensions||{},e.extensions["KHR_techniques_webgl"]={},e.extensions["KHR_techniques_webgl"].programs=e.programs,e.extensions["KHR_techniques_webgl"].shaders=e.shaders,e.extensions["KHR_techniques_webgl"].techniques=e.techniques;var n=e.extensions["KHR_techniques_webgl"].techniques;e.materials.forEach((function(t,i){e.materials[i].extensions["KHR_technique_webgl"].values=e.materials[i].values,e.materials[i].extensions["KHR_techniques_webgl"]=e.materials[i].extensions["KHR_technique_webgl"];var r=e.materials[i].extensions["KHR_techniques_webgl"];for(var o in r.values){var a=n[r.technique].uniforms;for(var s in a)if(a[s]===o){r.values[s]=r.values[o],delete r.values[o];break}}})),n.forEach((function(e){for(var t in e.attributes){var i=e.attributes[t];e.attributes[t]=e.parameters[i]}for(var n in e.uniforms){i=e.uniforms[n];e.uniforms[n]=e.parameters[i]}}))}}}),f=function(){Object.defineProperties(Cesium.Model.prototype,{_cachedGltf:{set:function(e){this._vtxf_cachedGltf=e,this._vtxf_cachedGltf&&this._vtxf_cachedGltf._gltf&&h(this._vtxf_cachedGltf._gltf)},get:function(){return this._vtxf_cachedGltf}}})};function d(e){var t=m();return function(){var i,n=Object(c["a"])(e);if(t){var r=Object(c["a"])(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Object(s["a"])(this,i)}}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var v=window,p=v.Cesium,g=function(e){Object(a["a"])(i,e);var t=d(i);function i(){var e;return Object(n["a"])(this,i),e=t.call(this),e.mapCenterLongitude=107.34145981478143,e.mapCenterLatitude=36.26907364872889,e.viewer=null,e.state=l["a"],window.mapSdk=Object(o["a"])(e),f(),e}return Object(r["a"])(i,[{key:"init",value:function(){p.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI1Y2EzNzVjYS04NmQyLTRmMTAtODJiOS1lZGM5ZDRiM2FhOWQiLCJpZCI6MTA2MzA4LCJpYXQiOjE2NjE4MjM0MTZ9.DGLjWbAslgVOr34TMPn0tN2UWXqafI4qWCGxzQ9G_nI",this.viewer=new p.Viewer("cesiumContainer",{animation:!1,baseLayerPicker:!1,geocoder:!1,infoBox:!1,selectionIndicator:!1,navigationHelpButton:!1,fullscreenButton:!1,timeline:!1,clock:new p.Clock,shadows:!0,shouldAnimate:!0}),this.viewer._cesiumWidget._creditContainer.style.display="none",this.resetZoomView(),this.initOtherMap()}},{key:"initOtherMap",value:function(){this.viewer.imageryLayers.addImageryProvider(new p.UrlTemplateImageryProvider({url:"https://webst04.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}"})),this.viewer.imageryLayers.addImageryProvider(new p.WebMapTileServiceImageryProvider({url:"https://onemapserver.img.net/OneMapServer/rest/services/2021_1M_04/Transfer",layer:"",format:"image/webp",tileMatrixSetID:"EPSG:3857",style:"default"}))}},{key:"add3DTileset",value:function(e){var t=this,i=e.url,n=e.heightDifference,r=void 0===n?0:n;if(i){this.tilesetObj&&(this.tilesetObj.destroy(),this.tilesetObj=null);var o=this.viewer.scene.primitives.add(new p.Cesium3DTileset({url:i,maximumMemoryUsage:100,maximumScreenSpaceError:500,maximumNumberOfLoadedTiles:1e3,shadows:!1,skipLevelOfDetail:!0,baseScreenSpaceError:1024,skipScreenSpaceErrorFactor:16,skipLevels:1,immediatelyLoadDesiredLevelOfDetail:!1,loadSiblings:!1,cullWithChildrenBounds:!0,dynamicScreenSpaceError:!0,dynamicScreenSpaceErrorDensity:.00278,dynamicScreenSpaceErrorFactor:4,dynamicScreenSpaceErrorHeightFalloff:.25}));this.viewer.scene.primitives.add(o),o.readyPromise.then((function(e){var i=p.Cartographic.fromCartesian(e.boundingSphere.center),n=p.Cartesian3.fromRadians(i.longitude,i.latitude,0),o=p.Cartesian3.fromRadians(i.longitude,i.latitude,r),a=p.Cartesian3.subtract(o,n,new p.Cartesian3);e.modelMatrix=p.Matrix4.fromTranslation(a),t.viewer.flyTo(e),console.log("HJJ -> MapSdk -> add3DTileset -> translation",a)})),this.tilesetObj=o}}},{key:"flyToPoint",value:function(e){var t=e.longitude,i=void 0===t?this.mapCenterLongitude:t,n=e.latitude,r=void 0===n?this.mapCenterLatitude:n,o=e.duration,a=void 0===o?2:o,s=e.height,c=void 0===s?5e3:s,u=e.heading,l=void 0===u?0:u,h=e.pitch,f=void 0===h?-89:h;this.viewer.scene.camera.flyTo({destination:p.Cartesian3.fromDegrees(i,r,c),orientation:{heading:p.Math.toRadians(l),pitch:p.Math.toRadians(f),roll:0},duration:a})}},{key:"resetZoomView",value:function(){this.flyToPoint({longitude:this.mapCenterLongitude,latitude:this.mapCenterLatitude,duration:1,height:this.zoomToHeight(2),heading:0,pitch:-90})}},{key:"resetPitch",value:function(){var e=this.getCurrentMapCenterPoint(),t=e.longitude,i=e.latitude;this.viewer.scene.camera.flyTo({destination:p.Cartesian3.fromDegrees(t,i,Math.ceil(this.viewer.camera.positionCartographic.height)),orientation:{heading:p.Math.toRadians(0),pitch:p.Math.toRadians(-90),roll:0},duration:2})}},{key:"zoomLevel",value:function(e){var t=this.zoomToHeight(e),i=this.getCurrentMapCenterPoint(),n=i.longitude,r=i.latitude;this.viewer.scene.camera.flyTo({destination:p.Cartesian3.fromDegrees(n,r,t),duration:1})}},{key:"getCurrentMapCenterPoint",value:function(){var e=this.viewer.camera.pickEllipsoid(new p.Cartesian2(this.viewer.canvas.clientWidth/2,this.viewer.canvas.clientHeight/2)),t=p.Ellipsoid.WGS84.cartesianToCartographic(e);return{longitude:180*t.longitude/Math.PI,latitude:180*t.latitude/Math.PI}}},{key:"zoomToHeight",value:function(e){var t=40487.57,i=7096758e-11,n=91610.74,r=-40467.74;return Math.round(n*Math.pow((t-r)/(e-r)-1,1/i))}},{key:"heightToZoom",value:function(e){var t=40487.57,i=7096758e-11,n=91610.74,r=-40467.74,o=Math.round(r+(t-r)/(1+Math.pow(e/n,i))).toFixed();return o<1&&(o=1),o>24&&(o=24),+o}}]),i}(Object(u["a"])(EventTarget));t["a"]=new g},c570:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.tiltPhotographyVisibility?i("div",{staticClass:"tilt-photography-tools"},[i("div",{staticClass:"title"},[e._v("加载倾斜摄影")]),i("div",{staticClass:"list"},e._l(e.cesium3DTilesetList,(function(t,n){return i("div",{key:n,staticClass:"list-item",on:{click:function(i){return e.clickItem(t)}}},[e._v(" "+e._s(t.label)+" ")])})),0)]):e._e()},r=[],o=i("5530"),a=i("2f62"),s=i("c218"),c={name:"TiltPhotography",data:function(){return{cesium3DTilesetList:[{label:"高桥",url:"https://higis.img.net/b3dm/gaoqiao_b3dm/tileset.json",heightDifference:-45},{label:"江华县白芒营镇小贝村",url:"https://higis.img.net/b3dm/3D_Unknown/tileset.json",heightDifference:-270}]}},computed:Object(o["a"])({},Object(a["b"])({tiltPhotographyVisibility:function(e){return e.tiltPhotographyVisibility||!1}})),components:{},methods:{clickItem:function(e){s["a"].add3DTileset(e)}}},u=c,l=(i("78a0"),i("2877")),h=Object(l["a"])(u,n,r,!1,null,"4c0e3b5b",null);t["default"]=h.exports},cc73:function(e,t,i){"use strict";var n=i("4f8e"),r=i.n(n);r.a},fcc2:function(e,t,i){"use strict";var n={tiltPhotographyVisibility:!1};t["a"]=n},ffe0:function(e,t,i){var n={"./CesiumMap.vue":"2fa2","./CesiumTools.vue":"a9c3","./TiltPhotography.vue":"c570"};function r(e){var t=o(e);return i(t)}function o(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id="ffe0"}});
//# sourceMappingURL=app.3e9c6871.js.map